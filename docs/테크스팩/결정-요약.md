# Tasteam Design System Spec (Figma AI Input)

이 문서는 **외부 링크/참조 없이 단독으로 사용 가능한** 디자인 시스템 스펙입니다.
모바일(first) 서비스인 Tasteam의 화면/컴포넌트/토큰을 한 번에 정의해, Figma AI에 그대로 입력 가능한 형태로 작성했습니다.

주의:

- 폰트 결정/아이콘 결정은 **이 문서에서 제외**합니다(placeholder로만 표기).
- 구현은 shadcn/ui 스타일(semantic tokens + Tailwind utility)과 호환되는 토큰 구조를 가정합니다.

---

## 1) 서비스 컨텍스트 (모바일)

### 제품 톤/키워드

- “맛집/모임/일정”을 빠르게 탐색하고 저장하고 공유하는 모바일 경험
- 밝고 활기찬 브랜드 톤 (브랜드 오렌지 강조)
- 카드/리스트/칩(태그)/탭 중심의 UI

### 주요 사용자 흐름(요약)

- 인증: 로그인/회원가입/온보딩 → 홈 진입
- 탐색: 홈/검색 → 음식점 상세 → 저장/공유/그룹에 추가
- 그룹: 그룹 리스트 → 그룹 상세 → 멤버/일정/후기/추천 관리
- 설정: 프로필/알림/권한/로그아웃

---

## 2) 컬러 시스템 (결정)

### 브랜드 컬러(결정)

- Brand Primary: `#FFAE42`
- `primary` 토큰은 위 브랜드 컬러를 사용합니다.

### 컬러 토큰 형식(결정)

- 컬러 토큰은 **HSL triplet**로 정의하고, 실제 사용 시 `hsl(var(--token))` 형태로 사용합니다.
  - 예: `background = hsl(var(--background))`

### Light Theme (기본)

- `background`: `0 0% 100%`
- `foreground`: `220.9 39.3% 11%`
- `card`: `0 0% 100%`
- `card-foreground`: `220.9 39.3% 11%`
- `popover`: `0 0% 100%`
- `popover-foreground`: `220.9 39.3% 11%`
- `primary`: `34.3 100% 62.9%` (Brand Primary)
- `primary-foreground`: `0 0% 100%`
- `secondary`: `210 40% 96.1%`
- `secondary-foreground`: `222.2 47.4% 11.2%`
- `muted`: `210 40% 96.1%`
- `muted-foreground`: `215.4 16.3% 46.9%`
- `accent`: `210 40% 96.1%`
- `accent-foreground`: `222.2 47.4% 11.2%`
- `destructive`: `0 84.2% 60.2%`
- `destructive-foreground`: `210 40% 98%`
- `border`: `214.3 31.8% 91.4%`
- `input`: `214.3 31.8% 91.4%`
- `ring`: `var(--primary)` (포커스 링은 primary 기반)

### Dark Theme (옵션)

다크 모드는 `background/foreground`를 중심으로 토큰을 오버라이드하며, `primary`는 브랜드 컬러로 유지합니다.

- `background`: `222.2 84% 4.9%`
- `foreground`: `210 40% 98%`
- `card`: `222.2 84% 4.9%`
- `card-foreground`: `210 40% 98%`
- `popover`: `222.2 84% 4.9%`
- `popover-foreground`: `210 40% 98%`
- `primary`: `34.3 100% 62.9%` (Brand Primary 유지)
- `primary-foreground`: `0 0% 100%`
- `secondary`: `217.2 32.6% 17.5%`
- `secondary-foreground`: `210 40% 98%`
- `muted`: `217.2 32.6% 17.5%`
- `muted-foreground`: `215 20.2% 65.1%`
- `accent`: `217.2 32.6% 17.5%`
- `accent-foreground`: `210 40% 98%`
- `destructive`: `0 62.8% 30.6%`
- `destructive-foreground`: `210 40% 98%`
- `border`: `217.2 32.6% 17.5%`
- `input`: `217.2 32.6% 17.5%`
- `ring`: `var(--primary)`

### Legacy 브랜드 토큰(호환)

기존 CSS에서 사용하던 brand 변수도 유지합니다(동일 톤).

- `--color-brand`: `hsl(var(--primary))`
- `--color-brand-strong`: `hsl(34.3 100% 52%)`
- `--color-brand-soft`: `hsl(34.3 100% 95%)`

---

## 3) 레이아웃/간격/반경/그림자 (결정)

### 스페이싱 스케일(결정)

모바일 UI는 4px 기반 스케일을 사용합니다.

- `space-0`: 0
- `space-1`: 4
- `space-2`: 8
- `space-3`: 12
- `space-4`: 16
- `space-5`: 20
- `space-6`: 24
- `space-8`: 32
- `space-10`: 40
- `space-12`: 48

### 코너 반경(결정)

- Base radius: 8px (`--radius = 0.5rem`)
- Radius 사용 가이드:
  - 버튼/칩/입력: 8px
  - 카드/시트/모달: 12px (필요 시)

### 그림자(결정)

- `shadow-1`: 작은 elevation (카드/서브 패널)
- `shadow-2`: 중간 elevation (시트/팝오버)
- `shadow-3`: 큰 elevation (모달/토스트)

(Figma에서는 1~3 레벨로 스타일 토큰화)

### 그리드/컨테이너(결정)

- 기본 레이아웃은 “single column” + 섹션 단위 구성
- 화면 좌우 padding: 16px 기본 (`space-4`)
- 카드 리스트 간격: 12px (`space-3`)
- 섹션 간격: 24px (`space-6`)

---

## 4) 타이포그래피 (폰트 제외, 스케일만 정의)

폰트 패밀리는 placeholder로 두고, **크기/행간/웨이트 스케일만** 정의합니다.

- Font Family: (TBD)
- Base text color: `foreground`, muted text: `muted-foreground`

### 타입 스케일(권장)

- `Display`: 24 / line 32 / weight 700
- `Title`: 20 / line 28 / weight 700
- `Heading`: 18 / line 26 / weight 600
- `Body`: 16 / line 24 / weight 400
- `Body Emphasis`: 16 / line 24 / weight 600
- `Caption`: 12 / line 18 / weight 400

---

## 5) 아이콘 (결정 제외)

- Icon set: (TBD)
- Icon size: 16 / 20 / 24 사용
- Icon-only button은 텍스트 레이블(접근성)을 반드시 포함(레이블은 Figma에서 “aria-label”로 표기)

---

## 6) 컴포넌트 시스템 (전체 목록)

### 공통 상태(모든 인터랙티브 컴포넌트)

- `default`
- `pressed/active`
- `disabled`
- `loading` (해당되는 경우)
- `focus-visible` (키보드 포커스)
- `error` (입력/검증 컴포넌트)

### 변형 규칙(기본)

- `primary`: 브랜드 강조
- `secondary`: 보조 CTA
- `ghost`/`link`: 경량 행동
- `destructive`: 삭제/위험 행동

### 6-1) Foundations / Layout

- `Container` (좌우 16px padding)
- `SafeArea` (상/하단 inset 고려)
- `Stack` (vertical spacing)
- `Inline` (horizontal spacing)
- `Divider` (border token 기반)
- `Card` (surface + shadow-1)

### 6-2) Navigation

- `TopAppBar` (title, left back, right actions)
- `BottomTabBar` (Home / Search / Groups / Profile, `More`는 옵션)
- `Breadcrumb` (딥한 화면에서 옵션)
- `Tabs` (그룹 상세/음식점 상세 내부 탭)
- `Pagination` (리스트 페이지에서 옵션)
- `Sidebar` (모바일에서는 사용 최소/옵션)

### 6-3) Actions

- `Button` (primary/secondary/ghost/destructive, sizes sm/md/lg, loading 포함)
- `IconButton` (label 필수)
- `Toggle`, `ToggleGroup`

### 6-4) Forms / Inputs

- `Input`
- `Textarea`
- `Label`
- `Checkbox`
- `RadioGroup`
- `Switch`
- `Select` / `NativeSelect`
- `Slider` (거리/인원/평점 필터 등에 사용)
- `Combobox` (검색 + 선택)
- `DatePicker` / `Calendar`
- `InputOTP` (인증 코드)
- `Field` (label/help/error 묶음)

### 6-5) Data Display

- `Avatar`
- `Badge` (태그/상태)
- `Table` / `DataTable`
- `Progress` (업로드/로딩)
- `Skeleton`
- `Tooltip`
- `HoverCard` (모바일에서는 롱프레스/옵션)

### 6-6) Feedback / Overlays

- `Alert`
- `AlertDialog`
- `Dialog` (modal)
- `Sheet` (bottom sheet)
- `Drawer` (드로어)
- `Popover`
- `DropdownMenu`
- `ContextMenu` (모바일에서는 옵션)
- `Toast` / `Sonner` (토스트)
- `Empty` (빈 상태)

### 6-7) Utilities

- `Separator`
- `ScrollArea`
- `Resizable` (모바일에서는 옵션)
- `Command` (커맨드 팔레트; 모바일에서는 검색 UI로 재해석)
- `Kbd` (모바일에서는 문서/옵션)
- `Typography` (텍스트 스타일 프리셋)

### 6-8) Content / Media

- `Carousel` (사진/추천 리스트)
- `AspectRatio` (이미지 비율 고정)
- `Chart` (통계/리포트가 필요한 경우)

---

## 7) 애니메이션 가이드 (간단)

### 목적

- 전환 맥락 제공(페이지/시트/모달)
- 상호작용 피드백(저장/좋아요/추가)
- 정보 위계(중요 섹션 강조)

### 원칙

- 사용자가 해야 할 일을 방해하지 않게 “짧고, 적게”
- 기본은 150~250ms, 강조 전환은 250~350ms
- `prefers-reduced-motion`을 고려해 모션을 줄이거나 제거 가능해야 함

### 권장 모션 패턴(모바일)

- Screen transition: fade + slight slide (Y 8~16)
- Bottom sheet: slide up + dim overlay
- List reveal: stagger(약하게)
- Loading: skeleton 또는 subtle spinner

---

## 8) 페이지 정보 구조 (전체 리스트업)

아래는 모바일 앱 기준 “기본 페이지 구성”입니다. 각 페이지는 “공통 레이아웃 + 섹션 + 핵심 컴포넌트”로 정의합니다.

### 8-1) 인증/온보딩

- `Splash`
  - 로고/브랜드 컬러 배경, 로딩 상태
- `Login`
  - 소셜 로그인 버튼, 이메일/비밀번호, 약관 링크
- `Signup`
  - 입력 폼, 중복 체크, 회원가입 완료
- `OTP / Verification`
  - 코드 입력(InputOTP), 재전송, 타이머
- `Onboarding`
  - 권한 안내(위치/알림), 관심사/선호 설정

### 8-2) 홈

- `Home`
  - 상단: 검색 진입(Input/Combobox)
  - 섹션: 추천 음식점 Carousel/리스트
  - 섹션: 내 그룹 요약(그룹 카드 리스트)
  - 섹션: 최근 본/저장한 항목

### 8-3) 검색

- `Search`
  - 검색바(Input), 최근 검색어, 추천 키워드(Badge/Chip)
  - 결과 탭: 음식점/그룹(또는 필터)
  - 필터 Sheet: 지역/가격/평점/거리(Slider/Select)

### 8-4) 음식점

- `Restaurant List`
  - 카드 리스트, 정렬 Dropdown(거리/평점/리뷰)
  - Empty / Skeleton / Pagination(옵션)
- `Restaurant Detail`
  - 헤더: 이미지 Carousel + 기본 정보
  - 액션: 저장/공유/그룹에 추가(Button/IconButton)
  - 섹션: 주소/지도(외부 지도 연동 영역)
  - 섹션: 메뉴/사진/후기(탭)
  - 섹션: 영업 시간/연락처/태그(Badge)
- `Write Review` (리뷰 작성)
  - 별점/태그/텍스트/사진 업로드(옵션)
  - 제출/취소, 검증 에러/로딩 처리

### 8-5) 그룹

- `Group List`
  - 내 그룹/추천 그룹, 검색, 정렬
- `Group Detail`
  - 헤더: 그룹 이름/설명/멤버 AvatarStack
  - 섹션: 하위 그룹(Sub Group) 목록
  - 탭: 일정/맛집 리스트/공지(옵션)
  - 액션: 초대/나가기/destructive
- `Sub Group Detail` (하위 그룹 상세)
  - 그룹 내 하위 단위(예: 특정 모임/테마)
  - 공간: 하위 그룹에서 찜한 것(모아보기), 하위 그룹 리뷰(모아보기)
  - 우측 상단: 작은 고정(fixed) 동그라미 채팅 아이콘(진입)
- `Sub Group Chat Room` (하위 그룹 채팅방)
  - 메시지 리스트 + 입력창 + 첨부(옵션)
- `Create Group` (그룹 생성)
  - 이름/설명/공개 설정(Switch), 생성 버튼
- `Apply Group` (그룹 신청)
  - 그룹 소개 확인, 신청 사유(옵션), 신청 버튼
- `Join Group` (그룹 참여)
  - 초대 코드/링크로 참여, 승인/거절(AlertDialog)
- `Invite / Join Group`
  - 초대 코드/링크, 승인/거절(AlertDialog)

### 8-6) 프로필/설정

- `My Page` (마이페이지)
  - 프로필 카드, 내 활동 요약, 저장 목록 진입
- `Edit Profile` (프로필 수정)
  - 닉네임/소개/프로필 이미지 변경(옵션)
- `My Favorites` (내가 찜)
  - 음식점/그룹 찜 리스트(필터/정렬 옵션)
- `My Reviews` (내가 작성한 리뷰)
  - 리뷰 리스트, 수정/삭제(옵션)
- `Settings` (설정)
  - 알림 설정(Switch), 위치 권한, 약관, 버전 정보
  - 로그아웃/탈퇴(Destructive)
- `Notification Settings` (알림 설정)
  - 푸시/이메일(옵션) 토글, 이벤트/리마인드 카테고리 토글

### 8-7) 공통/시스템

- `Notifications` (옵션)
  - 푸시 알림/인앱 알림 리스트(통합), 읽음 처리, 딥링크 이동
- `Error`
  - 에러 메시지 + 재시도 버튼
- `Empty State`
  - 비어 있음 안내 + 추천 행동

---

## 9) 페이지 내 공통 패턴 (모바일)

- 리스트 페이지:
  - 상단 검색/정렬 + 카드 리스트 + 스켈레톤 + 빈 상태
- 상세 페이지:
  - 헤더 이미지 + 핵심 액션 + 섹션(카드) + 하단 CTA(옵션)
- 모달/시트:
  - Dim overlay + Sheet/Dialog + 명확한 닫기/취소/확인

---

## 10) 페이지/위젯/컴포넌트 인벤토리 (전체 나열)

이 섹션은 “어떤 페이지가 존재하는지”, “각 페이지를 구성하는 위젯(큰 UI 블록)은 무엇인지”, “그 위젯이 어떤 컴포넌트를 필요로 하는지”를 한 번에 나열합니다.

표기 규칙:

- Page: 라우팅 단위 화면
- Widget: 페이지를 구성하는 큰 UI 블록(재사용 가능)
- Component: shared/ui 프리미티브 + 도메인 UI(entities) + 조합 컴포넌트(features/widgets)

### 10-1) 공통 위젯 목록 (여러 페이지에서 재사용)

- `AppShell`
  - 포함: `TopAppBar`, `BottomTabBar`, `SafeArea`, `Container`
- `TopAppBar`
  - 포함: `IconButton(Back)`, `Title`, `IconButton(Action)`, `Avatar`(옵션)
- `BottomTabBar`
  - 탭: Home / Search / Groups / Profile (기본), `More`는 옵션(5번째 탭)
  - 포함: `Icon`, `Label`, `Badge`(옵션)
- `SearchHeader`
  - 포함: `Input` 또는 `Combobox`, `IconButton(Filter)`, `ChipRow`(옵션)
- `FilterSheet`
  - 포함: `Sheet`, `Field`, `Select`, `Slider`, `Checkbox`, `RadioGroup`, `Button(Apply/Reset)`
- `SortMenu`
  - 포함: `DropdownMenu`, `Button(ghost)`, `CheckItem`
- `ListState`
  - 포함: `Skeleton`(로딩), `Empty`(빈 상태), `Alert`(에러), `Button(Retry)`
- `PullToRefresh` (옵션)
  - 모바일 UX 필요 시(웹뷰/브라우저 환경에 맞춤)
- `ShareSheet` (옵션)
  - 포함: `Sheet`, `Button`, `Input`(링크 복사)
- `FloatingChatButton` (고정 동그라미 아이콘)
  - 위치: 우측 상단(또는 우측 하단) 고정
  - 포함: `IconButton` 또는 `Button` + unread `Badge`(옵션)
- `NotificationBell` (옵션)
  - 위치: `TopAppBar` 우측 액션
  - 포함: 벨 아이콘 + unread `Badge`
- `AuthGuard` (시스템)
  - 인증 필요 페이지 진입 제어(리다이렉트/토스트)

### 10-2) 도메인(entities) UI 목록 (데이터 표현용)

- `RestaurantCard`
  - 포함: 썸네일(AspectRatio/Image), `Badge`(카테고리/태그), 이름/평점/거리 텍스트, 저장 버튼(IconButton)
- `RestaurantListItem` (컴팩트)
  - 포함: Avatar/Thumbnail, 1~2줄 텍스트, `Chevron` 아이콘
- `RestaurantMetaRow`
  - 포함: 아이콘+텍스트(주소/시간/전화)
- `ReviewCard` (옵션)
  - 포함: `Avatar`, 별점, 텍스트, 이미지(옵션)

- `GroupCard`
  - 포함: 커버(옵션), 제목/설명, 멤버 AvatarStack, 상태 Badge
- `GroupListItem` (컴팩트)
  - 포함: 제목/멤버 수/최근 활동, `Chevron`
- `SubGroupCard`
  - 포함: 제목/설명, 관련 찜/리뷰 카운트(옵션), `Chevron`
- `SubGroupListItem` (컴팩트)
  - 포함: 제목/요약, 카운트, `Chevron`
- `MemberRow`
  - 포함: `Avatar`, 이름/역할, `Button`(관리자 기능 옵션)

- `UserProfileCard`
  - 포함: `Avatar`, 닉네임, 보조정보, `Button(Edit)`

- `NotificationRow`
  - 포함: 아이콘/텍스트(제목/본문), 시간, 읽음 상태, `Chevron`(딥링크)

- `ChatMessageBubble` (채팅 메시지)
  - 포함: 발신자(옵션), 말풍선, 시간, 읽음 표시(옵션)

### 10-3) Feature UI 목록 (행동/시나리오 단위)

- `LoginForm` / `SignupForm`
  - 포함: `Field`, `Input`, `Button(Submit)`, `Alert`(에러)
- `SocialLoginButtons`
  - 포함: `Button`(provider별), 구분선(Separator)
- `OtpVerificationForm`
  - 포함: `InputOTP`, 타이머, `Button(Resend)`

- `SaveRestaurantButton`
  - 포함: `Toggle` 또는 `IconButton` + optimistic UI + 토스트
- `AddToGroupFlow` (옵션)
  - 포함: `Sheet/Dialog`, 그룹 선택 리스트, `Button(Confirm)`
- `InviteMemberFlow`
  - 포함: `Dialog`, 초대 링크/코드, 복사 버튼

- `ChatRoom`
  - 포함: 메시지 리스트, 입력 컴포저, 전송, 스크롤 고정, 읽음 처리(옵션)

- `PushPermissionPrompt` (옵션)
  - 포함: 권한 안내 카드 + `Button(Allow/Later)`

### 10-4) Page 별 구성 (Page -> Widgets -> Components)

#### Splash

- Widgets: `AppShell`(최소), `ListState(Loading)`
- Components: 로고 영역(이미지/텍스트), `Spinner` 또는 `Skeleton`

#### Login

- Widgets: `TopAppBar`(옵션), `LoginForm`, `SocialLoginButtons`
- Components: `Field`, `Input`, `Button`, `Separator`, `Alert`

#### Signup

- Widgets: `TopAppBar`, `SignupForm`
- Components: `Field`, `Input`, `Checkbox(약관)`, `Button`, `Alert`

#### OTP / Verification

- Widgets: `TopAppBar`, `OtpVerificationForm`
- Components: `InputOTP`, `Button`, `Text`(타이머), `Alert`

#### Onboarding

- Widgets: `TopAppBar`, `PermissionGuide`, `PreferenceForm`(옵션)
- Components: `Card`, `Checkbox/Switch`, `Button`, `Carousel`(옵션)

#### Home

- Widgets: `AppShell`, `SearchHeader`, `HomeRecommendations`, `HomeGroupSummary`, `HomeRecent`
- Components:
  - `RestaurantCard` 리스트/캐러셀, `GroupCard` 리스트
  - `Skeleton`/`Empty`/`Alert` 상태 컴포넌트

#### Search

- Widgets: `AppShell`, `SearchHeader`, `SearchResultsTabs`, `FilterSheet`, `SortMenu`
- Components:
  - `Tabs`, `Input/Combobox`, `RestaurantListItem`/`GroupListItem`
  - `Sheet` + 필터 폼 컴포넌트 묶음

#### Restaurant List

- Widgets: `TopAppBar` 또는 `SearchHeader`, `SortMenu`, `RestaurantList`
- Components: `RestaurantCard` 또는 `RestaurantListItem`, `ListState`

#### Restaurant Detail

- Widgets: `TopAppBar`, `RestaurantDetailHeader`, `RestaurantDetailActions`, `RestaurantDetailTabs`
- Components:
  - 헤더: `Carousel`, `Badge`, 텍스트(이름/평점/거리)
  - 액션: `SaveRestaurantButton`, `Button(공유/그룹추가)`
  - 탭: `Tabs`, `Card` 섹션, `RestaurantMetaRow`, `ReviewCard`(옵션)

#### Write Review (리뷰 작성)

- Widgets: `TopAppBar`, `ReviewWriteForm`
- Components:
  - `Field`, `Textarea`, `Select`(태그/방문 시점 옵션), `Button(Submit/Cancel)`
  - 별점 UI(옵션): `RatingInput`(커스텀 컴포넌트) 또는 `RadioGroup` 기반
  - 이미지 업로드(옵션): 업로더 컴포넌트 + `Carousel`(미리보기)
  - 상태: `Alert`(검증/실패), `Spinner`/`Button(loading)`

#### Group List

- Widgets: `AppShell`, `GroupListHeader`(검색/생성), `GroupList`
- Components: `GroupCard`/`GroupListItem`, `Button(Create)`, `ListState`

#### Group Detail

- Widgets: `TopAppBar`, `GroupDetailHeader`, `SubGroupListSection`, `GroupDetailTabs`, `InviteMemberFlow`(옵션)
- Components:
  - 헤더: `Card`, `AvatarStack`, `Badge`
  - 하위 그룹: `SubGroupCard` 리스트, `Empty`/`Skeleton`
  - 탭: `Tabs`
  - 섹션: 일정 리스트(리스트 아이템), 맛집 리스트(`RestaurantCard`), 멤버 리스트(`MemberRow`)
  - 위험 액션: `AlertDialog`(나가기/삭제)

#### Sub Group Detail (하위 그룹 상세)

- Widgets: `TopAppBar`, `SubGroupDetailHeader`, `SubGroupTabs`, `FloatingChatButton`
- Components:
  - 헤더: `Card`(하위 그룹 소개), `Badge`(상태/태그 옵션)
  - 탭(권장): `Tabs`(찜 / 리뷰 / 정보)
  - 찜: `RestaurantCard` 리스트 + `SortMenu`(옵션) + `ListState`
  - 리뷰: `ReviewCard` 리스트 + `ListState`
  - 우측 상단 고정 채팅: `FloatingChatButton`(unread badge 옵션)

#### Sub Group Chat Room (하위 그룹 채팅방)

- Widgets: `TopAppBar`, `ChatRoom`
- Components:
  - 메시지: `ChatMessageBubble` 리스트 + 날짜 구분선(옵션)
  - 입력: `Input` 또는 `Textarea` + `IconButton(Send)` + 첨부(옵션)
  - 상태: `Skeleton`(초기 로딩), `Alert`(실패), 재시도

#### Create Group

- Widgets: `TopAppBar`, `CreateGroupForm`
- Components: `Field`, `Input`, `Textarea`, `Switch`, `Button`

#### Apply Group (그룹 신청)

- Widgets: `TopAppBar`, `GroupApplyCard`, `GroupApplyForm`(옵션)
- Components:
  - `Card`(그룹 소개/규칙), `Textarea`(신청 사유 옵션), `Button(Apply)`, `Alert`(실패)
  - 승인 전 상태: `Badge`(Pending) 또는 안내 텍스트

#### Join Group (그룹 참여)

- Widgets: `TopAppBar`, `JoinGroupForm`, `AlertDialog`(승인/거절)
- Components: `Input`(코드), `Button(Join)`, `Alert`, `Skeleton`(검증 중)

#### Invite / Join Group

- Widgets: `TopAppBar`, `JoinGroupForm`, `AlertDialog`(승인/거절)
- Components: `Input`(코드), `Button`, `Alert`

#### Profile

- Widgets: `AppShell`, `UserProfileCard`, `ProfileMenu`
- Components: `Avatar`, `Card`, `ListItem`, `Chevron`, `Button(Edit)`

#### My Page (마이페이지)

- Widgets: `AppShell`, `UserProfileCard`, `MyPageSummary`, `MyPageMenu`
- Components:
  - `Card`(요약), `ListItem`(내가 찜/내 리뷰/설정/알림 설정), `Badge`(카운트 옵션)
  - CTA: `Button(Edit Profile)`

#### Edit Profile (프로필 수정)

- Widgets: `TopAppBar`, `EditProfileForm`
- Components: `Field`, `Input`(닉네임), `Textarea`(소개 옵션), `Button(Save)`, `Alert`

#### My Favorites (내가 찜)

- Widgets: `TopAppBar`, `Tabs`(음식점/그룹), `FavoritesList`, `SortMenu`(옵션)
- Components: `RestaurantCard`/`GroupCard`, `ListState`, `DropdownMenu`(정렬)

#### My Reviews (내가 작성한 리뷰)

- Widgets: `TopAppBar`, `MyReviewsList`, `SortMenu`(옵션)
- Components: `ReviewCard`, `ListState`, `AlertDialog`(삭제 확인), `Button`(수정/삭제 옵션)

#### Settings

- Widgets: `TopAppBar`, `SettingsList`, `DestructiveActions`
- Components:
  - 설정 항목: `Switch`, `Select`, `Separator`
  - 로그아웃/탈퇴: `Button(destructive)`, `AlertDialog`

#### Notification Settings (알림 설정)

- Widgets: `TopAppBar`, `NotificationSettingsList`
- Components: `Switch`(카테고리별), `Separator`, `Text`(설명), `Alert`(실패)

#### Notifications (옵션)

- Widgets: `TopAppBar`, `NotificationList`
- Components: `NotificationRow`, `Badge`(unread), `Empty`, `Skeleton`

#### Error / Empty (공통)

- Widgets: `ListState`
- Components: `Alert`, `Empty`, `Button(Retry)`

---

## 11) 메시지/피드백 패턴 (에러/토스트/대화창) - 상세 스펙

이 섹션은 “사용자에게 상태를 알려주는 UI(메시지)”를 일관되게 만들기 위한 규칙입니다.
동일한 사건(예: API 실패)도 **표현 레벨(인라인/섹션/페이지/전역)**에 따라 다른 컴포넌트를 사용합니다.

### 11-1) 메시지 분류(권장)

- **인라인(필드 단위)**: 입력 검증/형식 오류 → `Field`의 error text
- **폼/섹션 단위**: 제출 실패/권한 부족/일시적 오류 → `Alert` + `Button(Retry)`
- **페이지 단위(블로킹)**: 데이터 로드 실패/치명적 오류 → `Error` 페이지(또는 `ListState(Error)`)
- **전역(논블로킹)**: 저장 완료/링크 복사/가벼운 실패 → `Toast`

### 11-2) 에러 메시지(카피) 원칙(필수)

- 사용자에게 **무엇이 문제인지 + 어떻게 해결하는지**를 같이 말합니다.
- 개발자 용어/코드(예: 500, NullPointer)는 기본 UI에 노출하지 않습니다.
- 문장은 짧게(가능하면 1줄), 길어지면 2줄까지만(그 이상은 상세 화면/도움말로 분리).
- 동일 상황은 동일 문구를 재사용(“네트워크 오류”, “권한 필요”, “서버 오류” 등 표준 문구 세트 유지).

권장 문구 템플릿:

- 네트워크: “인터넷 연결을 확인하고 다시 시도해 주세요.”
- 서버/일시 장애: “요청을 처리하지 못했어요. 잠시 후 다시 시도해 주세요.”
- 권한/인증: “로그인이 필요해요. 다시 로그인해 주세요.”
- 검증(필드): “{필드명}을(를) {조건} 입력해 주세요.” (예: “비밀번호를 8자 이상 입력해 주세요.”)

### 11-3) 인라인 에러(필드 검증) 표시 규칙(권장)

- 위치: 필드 바로 아래(help text 자리) 고정
- 표현: 아이콘(옵션) + 짧은 문장, 색상만으로 구분하지 않음(텍스트 필수)
- 트리거:
  - `blur` 시 1차 검증(형식/필수)
  - 제출 시 전체 검증(모든 필드)
- 해제: 사용자가 수정하면 즉시(또는 다음 `blur`) 에러 제거

### 11-4) 폼/섹션 에러(제출 실패) 패턴(권장)

- 컴포넌트: `Alert`(variant=destructive) + `Button(Retry)` 또는 “다시 시도”
- 폼 상단/CTA 근처에 배치(사용자가 다음 행동을 바로 찾게)
- 가능하면 **부분 실패**(일부만 저장됨)는 명확히 분리해서 안내

### 11-5) 페이지 에러(로드 실패) 패턴(권장)

- 컴포넌트: `ListState` 또는 `Error` 페이지
- 구성:
  - 제목 1줄(“불러오지 못했어요”)
  - 설명 1줄(“잠시 후 다시 시도해 주세요”)
  - CTA: `Button(Retry)` (필수)
  - 보조 CTA(옵션): “홈으로”

### 11-6) 토스트(Toast / Sonner) 상세 규칙(권장)

토스트는 **논블로킹** 피드백에만 사용합니다(필드 검증/필수 의사결정에는 사용하지 않음).

- 사용 예:
  - 성공: 저장됨, 복사됨, 참여 신청 완료
  - 실패(경미): 복사 실패, 일시적 네트워크 실패(“재시도” 제공 가능)
- 위치(모바일): 화면 하단, `BottomTabBar`/SafeArea를 가리지 않게 오프셋 적용
- 지속 시간:
  - 기본 3s
  - action 버튼 포함 시 5~6s
  - 오류 토스트는 기본보다 약간 길게(예: 4~5s) 허용
- 콘텐츠: 최대 2줄(타이틀 1줄 + 보조 1줄 옵션)
- 동시 표시: 최대 2~3개까지만 스택(초과는 최신으로 대체)
- 액션(옵션): “되돌리기”, “재시도”, “열기” 등 1개까지만(복잡한 작업은 `Dialog/Sheet`로)

### 11-7) 대화창/시트 선택 기준(결정)

- `AlertDialog`: **되돌릴 수 없는 행동**(삭제/탈퇴/나가기) 확인, 권한/보안 관련 확인
- `Dialog`(modal): 작은 입력/설정(예: 닉네임 변경, 링크 공유 상세), 집중이 필요한 짧은 흐름
- `Sheet`(bottom sheet): 액션 리스트/선택/필터처럼 **리스트 기반**이고 모바일에 자연스러운 상호작용
- `Popover/DropdownMenu`: **짧은 옵션(3~7개)**, 현재 맥락에 붙는 메뉴(정렬/더보기)

### 11-8) Dialog / AlertDialog 공통 스펙(권장)

- 구성: `Title`(필수) + `Description`(옵션) + Actions(필수)
- 버튼:
  - 기본: 좌측 `Cancel`, 우측 `Confirm`
  - 위험 행동: `Confirm`는 destructive 스타일 + 문구를 구체적으로(“삭제하기”, “탈퇴하기”)
- 닫기:
  - `Dialog`: overlay click/ESC로 닫기 허용(단, 데이터 유실 위험이 있으면 확인 추가)
  - `AlertDialog`: overlay click으로 닫기 비권장(명시적 선택 유도)

---

## 12) 부수 기능/미구현(옵션) 기능 상세 가이드

이 섹션은 현재 구현 여부와 무관하게, 추후 추가될 수 있는 기능의 UI 동작을 미리 정의합니다.

### 12-1) 드롭다운(정렬/더보기) 사용 가이드(권장)

- `DropdownMenu`는 **짧고 단순한 선택**에만 사용(3~7개 항목 권장)
- 항목이 길거나 검색이 필요하면 `Sheet + RadioGroup/Select/Combobox`로 전환
- 정렬 메뉴(`SortMenu`)는 체크 표시(`CheckItem` 또는 radio)로 현재 선택을 노출
- “더보기(…)" 오버플로 메뉴는 **페이지 핵심 CTA를 대체하지 않음**

### 12-2) More Tab (옵션) / 오버플로 내비게이션(권장)

기본은 `BottomTabBar` 4개 탭(Home/Search/Groups/Profile)을 유지하고,
부가 기능은 아래 중 하나로 제공합니다.

- 옵션 A: `Profile` 내부 메뉴로 흡수(설정/약관/버전/고객센터 등)
- 옵션 B: `TopAppBar` 우측 “더보기(…)" `DropdownMenu`/`Sheet`
- 옵션 C: 바텀 탭에 `More`를 추가(5번째 탭)하고, More 화면은 “메뉴 리스트”로 구성

More 화면(옵션 C) 구성 예:

- 섹션: 계정(프로필/로그아웃/탈퇴), 알림(설정/알림함), 앱 정보(버전/약관/오픈소스), 도움말/문의
- UI: `ListItem` + `Chevron`, 상태 `Badge`(unread/NEW) 옵션, 섹션 구분 `Separator`

### 12-3) Pull-to-Refresh (옵션) 가이드(권장)

- 대상: 리스트/피드 화면(홈 추천, 검색 결과, 그룹 리스트 등)
- 동작:
  - 당김 중: 진행 상태 표시(미세한 스피너/텍스트)
  - 성공: 리스트 갱신 + 짧은 토스트(옵션: “새로고침 완료”)
  - 실패: 상단에 작은 `Alert` 또는 토스트 + “재시도”

### 12-4) Pagination / Infinite Scroll (옵션) 가이드(권장)

- 기본은 모바일 UX에 맞게 Infinite Scroll(페이지 하단 로딩) 권장
- 명시적 페이지 이동이 필요한 경우에만 `Pagination` 사용(검색 결과 등)
- 로딩/에러:
  - 추가 로딩: 리스트 하단 `Skeleton`/spinner
  - 추가 로드 실패: 하단에 “더 불러오기 실패” + `Button(Retry)`

### 12-5) 공유(ShareSheet) / 복사 피드백(권장)

- 공유 진입은 `IconButton(Share)`로 제공
- 공유 옵션이 2개 이상이면 `Sheet(ShareSheet)` 사용
- 복사 완료는 토스트로 통일: “링크가 복사됐어요”

### 12-6) 채팅(첨부/시스템 메시지) 확장(옵션) 가이드(권장)

- 첨부는 입력창 옆 `IconButton(+)` → `Sheet`로 액션 제공(사진/위치 등)
- 시스템 메시지(입장/퇴장/공지)는 말풍선이 아닌 **센터 정렬 라벨**로 구분(옵션)
- 전송 실패:
  - 개별 메시지에 실패 표시 + “재시도”
  - 전역 장애는 상단 배너/`Alert`로 안내

---

## 13) 그룹 내 채팅방 테크 스펙 (Frontend + API Contract)

이 섹션은 “그룹/하위 그룹 채팅방(Sub Group Chat Room)”을 구현하기 위한 기술 스펙입니다.
현재 레포는 FE 중심이므로, **백엔드와 합의해야 하는 API/이벤트 계약(contract)**을 함께 정의합니다.

### 13-1) 범위/전제(권장)

- 채팅방 단위: `roomId` (그룹/하위 그룹 모두 동일한 “채팅방” 개념으로 추상화)
- 메시지 리스트는 **최신이 아래**(일반 메신저 UX), 입력창은 하단 고정
- 전달 보장: 기본은 **at-least-once**(중복 가능)로 보고, 클라이언트에서 dedupe 처리

### 13-2) 데이터 모델(권장)

- `ChatRoom`
  - `id`, `title`, `memberCount`, `lastMessage`, `updatedAt`
- `ChatMessage`
  - `id`(server id), `clientMessageId`(uuid; optimistic/dedupe용)
  - `roomId`, `senderId`, `senderName`(옵션), `senderAvatarUrl`(옵션)
  - `type`: `text` | `image` | `system` (필요 시 확장)
  - `text`(옵션), `attachments`(옵션)
  - `createdAt`, `editedAt`(옵션), `deletedAt`(옵션)
- `Attachment`
  - `id`, `type`, `url`, `thumbnailUrl`(옵션), `width/height`(옵션), `sizeBytes`(옵션)
- `ReadState`(방 단위)
  - `roomId`, `userId`, `lastReadMessageId`, `lastReadAt`

### 13-3) HTTP API Contract (초기 로드/히스토리/업로드)

권장 원칙:

- 히스토리는 cursor 기반(무한 스크롤)으로 가져오며, 기본 정렬은 `createdAt` 오름차순(렌더링은 아래로 쌓기)
- 파일 업로드는 presigned URL 방식(또는 multipart) 중 하나로 통일

예시 엔드포인트(예시이므로 서버와 확정 필요):

- 채팅방 메타
  - `GET /api/v1/chat/rooms/{roomId}`
- 메시지 히스토리(과거 불러오기)
  - `GET /api/v1/chat/rooms/{roomId}/messages?cursor={messageId|timestamp}&limit=30&direction=older`
  - 응답: `{ items: ChatMessage[], nextCursor: string|null }`
- 읽음 처리
  - `POST /api/v1/chat/rooms/{roomId}/read` body: `{ lastReadMessageId }`
- 첨부 업로드(옵션 A: presigned)
  - `POST /api/v1/chat/attachments/presign` body: `{ fileName, contentType, sizeBytes }`
  - `PUT {presignedUrl}` (직접 업로드)
  - `POST /api/v1/chat/attachments/complete` body: `{ uploadId }` → `Attachment`

### 13-4) 실시간 Contract (WebSocket 권장)

#### 연결/인증(결정 필요, 권장안 포함)

브라우저 WebSocket은 임의 헤더(Authorization) 주입이 제한적이므로, 아래 중 하나를 권장합니다.

- 권장안 A(추천): **WS ticket 방식**
  - `POST /api/v1/chat/ws-ticket` → `{ ticket, expiresAt }` (짧은 TTL)
  - `wss://{WS_BASE}/ws/chat?ticket=...`로 연결
- 대안 B: query string에 `accessToken` 직접 전달(운영 로그/프록시 노출 위험 → 지양)
- 대안 C: access token을 httpOnly cookie로 전환(인증 체계 변경 필요)

환경변수(권장):

- `VITE_WS_BASE_URL`를 추가하거나, `VITE_API_BASE_URL`에서 `http(s)` → `ws(s)`로 변환해 사용

#### 구독/이벤트 타입(권장)

- client → server
  - `room.subscribe` `{ roomId, lastReceivedMessageId? }`
  - `message.send` `{ roomId, clientMessageId, type, text?, attachmentIds? }`
  - `message.retry` `{ roomId, clientMessageId }` (옵션)
  - `read.update` `{ roomId, lastReadMessageId }`
  - `typing.start|typing.stop` (옵션)
- server → client
  - `message.created` `{ message: ChatMessage }`
  - `message.ack` `{ clientMessageId, messageId, createdAt }` (optimistic 확정용)
  - `message.failed` `{ clientMessageId, errorCode }`
  - `read.updated` `{ roomId, userId, lastReadMessageId, lastReadAt }`
  - `room.updated` `{ roomId, lastMessage, updatedAt }`
  - `presence.updated`/`typing.updated` (옵션)

중복/정렬 규칙(필수):

- `message.created`는 중복 수신 가능 → `message.id` 기준으로 dedupe
- optimistic 메시지는 `clientMessageId`로 먼저 렌더링하고, `message.ack`로 `id/createdAt`을 확정
- 정렬 우선순위: `createdAt` → `id`(또는 server sequence)

### 13-5) 프론트엔드 상태/캐시 전략(권장)

- Room별 상태
  - `messagesByRoomId`: 메시지 맵(id/clientMessageId) + 정렬된 id 리스트
  - `pendingMessages`: 전송 중/실패 메시지(재시도 가능)
  - `cursor`: 과거 불러오기용 `nextCursor`
  - `unreadCount`/`lastReadMessageId`
- 화면 진입 시 흐름
  1. `GET room meta` + `GET messages(limit=30)`로 초기 로드
  2. WS 연결 및 `room.subscribe`
  3. 화면이 “바닥에 붙어있는 상태”라면 신규 메시지 수신 시 자동 스크롤
  4. 사용자가 위로 스크롤 중이면 자동 스크롤 금지 + “새 메시지 N개” 버튼 노출(옵션)

### 13-6) 스크롤/페이징(필수)

- 과거 메시지 로드(위로 스크롤):
  - 상단 근처 도달 시 `GET .../messages?direction=older`
  - prepend 시 **현재 스크롤 위치 유지**(prepend 전/후 `scrollHeight` 차이를 보정)
- 최신 유지:
  - 사용자가 바닥 근처(예: 80px 이내)일 때만 자동 스크롤
- 성능:
  - 메시지 DOM이 커지면 windowing(가상 스크롤) 도입을 고려(남은 결정)

### 13-7) 전송/실패/재시도 UX(필수)

- 전송은 optimistic으로 즉시 리스트에 추가(`clientMessageId` 생성)
- 전송 실패 시:
  - 해당 버블에 실패 표시 + “재시도” 액션(개별 재시도)
  - 재시도는 동일 `clientMessageId`로 재전송하여 중복 생성 방지
- 중복 클릭 방지: send 버튼은 전송 직후 짧은 debounce(예: 300ms)

### 13-8) 읽음/안읽음 & unread badge(권장)

- 읽음 기준(권장):
  - 채팅방이 포커스/가시 상태이고, 사용자가 “바닥”에 도달했을 때 마지막 메시지를 read로 업데이트
- unread 배지:
  - `FloatingChatButton`/리스트에서 `unreadCount`를 표시(옵션)
  - 방 밖에서 수신한 메시지는 `unreadCount + 1` (서버 값과 eventually consistent)

### 13-9) 보안/권한(필수)

- 서버는 `roomId`에 대한 멤버십/권한을 항상 검증
- 클라이언트는 토큰 만료/401 상황에서:
  - HTTP는 refresh 흐름을 따르고(기존 axios interceptor),
  - WS는 ticket 재발급(권장안 A) 후 재연결
- 개인정보/민감정보는 메시지로 전송하지 않도록 도메인 레벨에서 제한(필요 시 금칙어/필터는 서버 담당)

### 13-10) 장애/재연결(필수)

- 연결 끊김 시 exponential backoff 재연결(예: 1s → 2s → 5s → 10s → 30s, max 30s)
- 재연결 후 `room.subscribe`에 `lastReceivedMessageId`를 포함해 누락 메시지 복구(서버 지원 필요)
- 장기 오프라인 후에는 HTTP 히스토리 재조회로 동기화

### 13-11) 프론트 구현 구조(권장, FSD 기준)

- `entities/chat`
  - types: `ChatRoom`, `ChatMessage`, `ReadState`
  - api: room/meta, history, read, ws-ticket(권장안 A 사용 시)
- `features/chat-room`
  - `connectRoom(roomId)`: WS 연결/구독/재연결
  - `sendMessage(...)`: optimistic + ack 처리
  - `loadOlderMessages(...)`: cursor 기반 prepend
  - `markAsRead(...)`: 바닥 도달 시 read 업데이트
- `widgets/chat-room`
  - 메시지 리스트, 날짜 구분선, “새 메시지 N개” 버튼(옵션), 입력 컴포저(첨부/전송)
- `pages/sub-group-chat-room`
  - 라우팅/권한 가드, `roomId` 파라미터 결정(그룹/하위 그룹과의 매핑)
